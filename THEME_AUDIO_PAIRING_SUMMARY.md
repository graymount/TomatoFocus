# ğŸ¨ğŸµ ä¸»é¢˜ä¸éŸ³é¢‘é…å¯¹åŠŸèƒ½å®ç°å®ŒæˆæŠ¥å‘Š

## ğŸ“… å®Œæˆæ—¥æœŸ: 2025-01-20

---

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

æ ¹æ®ç”¨æˆ·éœ€æ±‚ï¼Œä¸ºæ¯ç§ä¸»é¢˜é…ç½®äº†å¯¹åº”çš„é»˜è®¤èƒŒæ™¯éŸ³ä¹ï¼Œå®ç°äº†ä¸»é¢˜ä¸éŸ³æ•ˆçš„å®Œç¾é…å¯¹ï¼Œä¸ºç”¨æˆ·æä¾›æ›´æ²‰æµ¸çš„ä½“éªŒã€‚

---

## âœ… ä¸»é¢˜éŸ³é¢‘é…å¯¹æ–¹æ¡ˆ

| ä¸»é¢˜ | Emoji | é»˜è®¤éŸ³æ•ˆ | éŸ³æ•ˆå›¾æ ‡ | é…å¯¹ç†ç”± |
|------|-------|----------|----------|----------|
| ğŸŒ¸ æ£®æ— | ğŸŒ¸ | Forest | ğŸƒ | æ£®æ—æ°›å›´ä¸è‡ªç„¶æ£®æ—éŸ³æ•ˆå®Œç¾åŒ¹é… |
| ğŸŒŠ æµ·æ´‹ | ğŸŒŠ | Ocean Waves | ğŸŒŠ | æµ·æ´‹ä¸»é¢˜ä¸æµ·æµªå£°è‡ªç„¶å‘¼åº” |
| â˜• å’–å•¡å… | â˜• | Cafe Ambience | â˜• | å’–å•¡å…ä¸»é¢˜ä¸å’–å•¡å…ç¯å¢ƒéŸ³å®Œç¾å¥‘åˆ |
| ğŸŒ™ æç®€ | ğŸŒ™ | White Noise | ğŸ”Š | æç®€é£æ ¼é…ç™½å™ªéŸ³ï¼Œçº¯å‡€æ— å¹²æ‰° |
| ğŸµ Lofi | ğŸµ | Rain | ğŸŒ§ï¸ | Lofié£æ ¼é…é›¨å£°ï¼Œè¥é€ æ”¾æ¾æ°›å›´ |
| ğŸš€ ç§‘æŠ€ | ğŸš€ | White Noise | ğŸ”Š | ç§‘æŠ€æ„Ÿé…ç™½å™ªéŸ³ï¼Œä¸“æ³¨é«˜æ•ˆ |

---

## ğŸ› ï¸ æŠ€æœ¯å®ç°è¯¦æƒ…

### 1. AppTheme ç»“æ„æ›´æ–°

```swift
struct AppTheme: Identifiable, Codable {
    let id: String
    let name: String
    let emoji: String
    
    // æ–°å¢ï¼šé»˜è®¤éŸ³æ•ˆé…ç½®
    let defaultSoundId: String
    
    // å…¶ä»–ä¸»é¢˜å±æ€§...
}
```

### 2. ThemeManager åŠŸèƒ½å¢å¼º

#### æ–°å¢æ–¹æ³•
```swift
// è·å–å½“å‰ä¸»é¢˜çš„é»˜è®¤éŸ³æ•ˆ
func getThemeDefaultSound() -> AudioManager.BackgroundSound? {
    return AudioManager.BackgroundSound(rawValue: currentTheme.defaultSoundId)
}

// åˆ‡æ¢åˆ°ä¸»é¢˜é»˜è®¤éŸ³æ•ˆ
private func switchToThemeDefaultSound() {
    if let defaultSound = getThemeDefaultSound() {
        DispatchQueue.main.async {
            AudioManager.shared.selectSound(defaultSound)
        }
    }
}
```

#### è‡ªåŠ¨åˆ‡æ¢é€»è¾‘
```swift
func setTheme(_ theme: AppTheme) {
    currentTheme = theme
    userDefaults.set(theme.id, forKey: themeKey)
    
    // è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸»é¢˜é»˜è®¤éŸ³æ•ˆ
    switchToThemeDefaultSound()
}
```

#### å¯åŠ¨æ—¶éŸ³æ•ˆåŒæ­¥
```swift
init() {
    // åŠ è½½ä¿å­˜çš„ä¸»é¢˜
    let savedThemeId = userDefaults.string(forKey: themeKey) ?? "forest"
    self.currentTheme = Self.predefinedThemes.first { $0.id == savedThemeId } ?? Self.predefinedThemes[0]
    
    // å»¶è¿ŸåŒæ­¥éŸ³æ•ˆç¡®ä¿AudioManagerå·²å‡†å¤‡å°±ç»ª
    DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) {
        self.switchToThemeDefaultSound()
    }
}
```

### 3. UIç•Œé¢æ”¹è¿›

#### ä¸»é¢˜å¡ç‰‡å‡çº§
- æ˜¾ç¤ºä¸»é¢˜åç§°å’Œemoji
- æ–°å¢é»˜è®¤éŸ³æ•ˆä¿¡æ¯æ˜¾ç¤º
- ä½¿ç”¨éŸ³æ•ˆå›¾æ ‡å’Œåç§°
- å¡ç‰‡é«˜åº¦ä»80è°ƒæ•´ä¸º100ä»¥å®¹çº³æ–°ä¿¡æ¯

```swift
// æ˜¾ç¤ºé»˜è®¤éŸ³æ•ˆä¿¡æ¯
if let sound = defaultSound {
    HStack(spacing: 4) {
        Image(systemName: sound.iconName)
            .font(.caption2)
        Text(sound.displayName)
            .font(.caption2)
    }
    .foregroundColor(theme.primaryText.opacity(0.8))
}
```

#### å½“å‰ä¸»é¢˜å¡ç‰‡å¢å¼º
- æ˜¾ç¤ºå½“å‰ä¸»é¢˜çš„é»˜è®¤éŸ³æ•ˆ
- ä½¿ç”¨å¼ºè°ƒè‰²é«˜äº®éŸ³æ•ˆå›¾æ ‡
- æ¸…æ™°çš„ä¿¡æ¯å±‚æ¬¡ç»“æ„

```swift
// æ˜¾ç¤ºå½“å‰ä¸»é¢˜é»˜è®¤éŸ³æ•ˆ
if let defaultSound = themeManager.getThemeDefaultSound() {
    HStack(spacing: 6) {
        Image(systemName: defaultSound.iconName)
            .font(isIPad ? .callout : .caption)
            .foregroundColor(themeManager.currentTheme.accent)
        
        Text("é»˜è®¤éŸ³æ•ˆ: \(defaultSound.displayName)")
            .font(isIPad ? .callout : .caption)
            .foregroundColor(themeManager.currentTheme.secondaryText)
    }
}
```

---

## ğŸµ éŸ³æ•ˆåŒ¹é…ç­–ç•¥

### è‡ªç„¶ä¸»é¢˜ç»„
- **ğŸŒ¸ æ£®æ—** â†’ **ğŸƒ Forest**: è‡ªç„¶æ£®æ—ç¯å¢ƒéŸ³ï¼Œé¸Ÿé¸£è™«å«
- **ğŸŒŠ æµ·æ´‹** â†’ **ğŸŒŠ Ocean Waves**: æµ·æµªæ‹å²¸å£°ï¼Œè¥é€ æµ·è¾¹æ°›å›´

### ç”Ÿæ´»åœºæ™¯ç»„
- **â˜• å’–å•¡å…** â†’ **â˜• Cafe Ambience**: å’–å•¡å…ç¯å¢ƒéŸ³ï¼Œè½»æ¾ç¤¾äº¤æ°›å›´

### ä¸“æ³¨æ•ˆç‡ç»„
- **ğŸŒ™ æç®€** â†’ **ğŸ”Š White Noise**: çº¯å‡€ç™½å™ªéŸ³ï¼Œæ— å¹²æ‰°ä¸“æ³¨
- **ğŸš€ ç§‘æŠ€** â†’ **ğŸ”Š White Noise**: æŠ€æœ¯å·¥ä½œç¯å¢ƒï¼Œæå‡ä¸“æ³¨åŠ›

### æ”¾æ¾åˆ›æ„ç»„
- **ğŸµ Lofi** â†’ **ğŸŒ§ï¸ Rain**: é›¨å£°é…åˆLofié£æ ¼ï¼Œè¥é€ åˆ›æ„æ°›å›´

---

## ğŸ”„ ç”¨æˆ·äº¤äº’æµç¨‹

### ä¸»é¢˜åˆ‡æ¢è‡ªåŠ¨éŸ³æ•ˆåˆ‡æ¢
1. ç”¨æˆ·åœ¨é…ç½®é¡µé¢é€‰æ‹©æ–°ä¸»é¢˜
2. ThemeManager.setTheme() è¢«è°ƒç”¨
3. ä¸»é¢˜èƒŒæ™¯å’ŒUIè‡ªåŠ¨æ›´æ–°
4. è‡ªåŠ¨åˆ‡æ¢åˆ°å¯¹åº”çš„é»˜è®¤éŸ³æ•ˆ
5. AudioManager å¼€å§‹æ’­æ”¾æ–°éŸ³æ•ˆ

### å¯åŠ¨æ—¶éŸ³æ•ˆåŒæ­¥
1. åº”ç”¨å¯åŠ¨ï¼ŒThemeManager åˆå§‹åŒ–
2. åŠ è½½ç”¨æˆ·ä¸Šæ¬¡é€‰æ‹©çš„ä¸»é¢˜
3. å»¶è¿Ÿ0.5ç§’ç¡®ä¿AudioManagerå‡†å¤‡å°±ç»ª
4. è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸»é¢˜å¯¹åº”çš„é»˜è®¤éŸ³æ•ˆ

### æ‰‹åŠ¨éŸ³æ•ˆè°ƒæ•´
- ç”¨æˆ·ä»å¯åœ¨ä¸»é¡µé¢æ‰‹åŠ¨é€‰æ‹©ä¸åŒéŸ³æ•ˆ
- ä½†åˆ‡æ¢ä¸»é¢˜æ—¶ä¼šé‡ç½®ä¸ºä¸»é¢˜é»˜è®¤éŸ³æ•ˆ

---

## ğŸ“± ç”¨æˆ·ä½“éªŒæå‡

### ä¸€é”®æ²‰æµ¸ä½“éªŒ
- é€‰æ‹©ä¸»é¢˜ = è‡ªåŠ¨è·å¾—é…å¥—éŸ³æ•ˆ
- æ— éœ€é¢å¤–é…ç½®ï¼Œå³åˆ»è¿›å…¥ä¸»é¢˜æ°›å›´
- é™ä½ç”¨æˆ·çš„é€‰æ‹©è´Ÿæ‹…

### è§†è§‰éŸ³æ•ˆåè°ƒ
- ä¸»é¢˜è§†è§‰é£æ ¼ä¸éŸ³æ•ˆå®Œç¾åŒ¹é…
- å¢å¼ºç•ªèŒ„é’Ÿä½¿ç”¨æ—¶çš„æ²‰æµ¸æ„Ÿ
- æä¾›æ›´ä¸“ä¸šçš„ç”¨æˆ·ä½“éªŒ

### æ™ºèƒ½é»˜è®¤é…ç½®
- æ–°ç”¨æˆ·å¼€ç®±å³ç”¨ä½“éªŒä¼˜åŒ–
- ä¸“ä¸šçš„ä¸»é¢˜éŸ³æ•ˆæ­é…æ–¹æ¡ˆ
- ä¿æŒæ‰‹åŠ¨è°ƒæ•´çš„çµæ´»æ€§

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### ç¼–è¯‘æµ‹è¯•
- âœ… **çŠ¶æ€**: æˆåŠŸé€šè¿‡
- âœ… **ç›®æ ‡**: iPad Air 11-inch (M3) æ¨¡æ‹Ÿå™¨
- âœ… **ç»“æœ**: æ— è¯­æ³•é”™è¯¯ï¼Œä»…æœ‰ä¸€ä¸ªéå…³é”®è­¦å‘Š

### åŠŸèƒ½éªŒè¯è®¡åˆ’
- [ ] ä¸»é¢˜åˆ‡æ¢æ—¶éŸ³æ•ˆè‡ªåŠ¨åˆ‡æ¢
- [ ] åº”ç”¨å¯åŠ¨æ—¶éŸ³æ•ˆä¸ä¸»é¢˜åŒæ­¥
- [ ] ä¸»é¢˜å¡ç‰‡æ­£ç¡®æ˜¾ç¤ºé»˜è®¤éŸ³æ•ˆä¿¡æ¯
- [ ] å½“å‰ä¸»é¢˜å¡ç‰‡æ˜¾ç¤ºéŸ³æ•ˆä¿¡æ¯
- [ ] iPadé€‚é…æ­£å¸¸å·¥ä½œ

---

## ğŸ“‹ æ–‡ä»¶ä¿®æ”¹æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶
1. **TomatoFocus/Models/ThemeManager.swift**
   - åœ¨AppThemeä¸­æ–°å¢defaultSoundIdå±æ€§
   - ä¸º6ä¸ªé¢„å®šä¹‰ä¸»é¢˜é…ç½®é»˜è®¤éŸ³æ•ˆ
   - æ–°å¢getThemeDefaultSound()æ–¹æ³•
   - æ–°å¢switchToThemeDefaultSound()æ–¹æ³•
   - ä¿®æ”¹setTheme()æ·»åŠ è‡ªåŠ¨éŸ³æ•ˆåˆ‡æ¢
   - ä¿®æ”¹init()æ·»åŠ å¯åŠ¨æ—¶éŸ³æ•ˆåŒæ­¥

2. **TomatoFocus/Views/ConfigurationView.swift**
   - ä¿®æ”¹ThemeCardç»„ä»¶æ˜¾ç¤ºé»˜è®¤éŸ³æ•ˆä¿¡æ¯
   - ä¿®æ”¹currentThemeCardæ˜¾ç¤ºå½“å‰ä¸»é¢˜éŸ³æ•ˆ
   - è°ƒæ•´å¡ç‰‡é«˜åº¦é€‚åº”æ–°å†…å®¹

### æ–°å¢åŠŸèƒ½
- ä¸»é¢˜éŸ³æ•ˆè‡ªåŠ¨é…å¯¹ç³»ç»Ÿ
- ä¸»é¢˜å¡ç‰‡éŸ³æ•ˆä¿¡æ¯æ˜¾ç¤º
- å¯åŠ¨æ—¶éŸ³æ•ˆä¸»é¢˜åŒæ­¥

---

## ğŸš€ ç”¨æˆ·ä»·å€¼

### ä½“éªŒä¸€è‡´æ€§
- è§†è§‰ä¸»é¢˜ä¸å¬è§‰ä½“éªŒå®Œç¾ç»Ÿä¸€
- å‡å°‘ç”¨æˆ·çš„è®¤çŸ¥è´Ÿè·
- æä¾›ä¸“ä¸šçº§åº”ç”¨ä½“éªŒ

### æ™ºèƒ½åŒ–é…ç½®
- è‡ªåŠ¨åŒ–çš„æœ€ä½³é…ç½®ç»„åˆ
- å‡å°‘ç”¨æˆ·é…ç½®æ—¶é—´
- æå‡ä½¿ç”¨æ•ˆç‡

### ä¸ªæ€§åŒ–ä¿æŒ
- ä¿ç•™æ‰‹åŠ¨éŸ³æ•ˆé€‰æ‹©èƒ½åŠ›
- åœ¨è‡ªåŠ¨åŒ–å’Œä¸ªæ€§åŒ–é—´å¹³è¡¡
- é€‚åº”ä¸åŒç”¨æˆ·éœ€æ±‚

---

**å®ç°è´Ÿè´£äºº**: AIå¼€å‘åŠ©æ‰‹  
**å®Œæˆæ—¶é—´**: 2025-01-20  
**çŠ¶æ€**: âœ… å®Œæˆï¼Œå·²ç¼–è¯‘é€šè¿‡ 